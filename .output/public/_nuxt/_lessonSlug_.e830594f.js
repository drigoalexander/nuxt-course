import{d as V,o as C,c as f,r as b,a as L,t as m,n as I,b as P,u as y,e as S,w as x,f as g,g as T,h,i,j as v,k as z}from"./entry.e8c8c236.js";import{u as D,a as N}from"./useCourse.77b1cffa.js";import{_ as O}from"./_plugin-vue_export-helper.c27b6911.js";const U=["src"],A=V({__name:"VideoPlayer",props:{videoID:{type:Number,required:!0}},setup(t){const e=t;return(s,n)=>(C(),f("iframe",{src:`https://player.vimeo.com/video/${e.videoID}`,width:"100%",height:"100%",frameborder:"0",title:"{video_title}",webkitallowfullscreen:"",mozallowfullscreen:"",allowfullscreen:""},null,8,U))}}),E=V({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(t,{slots:e,attrs:s}){const n=b(!1);return L(()=>{n.value=!0}),o=>{var a;if(n.value)return(a=e.default)==null?void 0:a.call(e);const l=e.fallback||e.placeholder;if(l)return l();const d=o.fallback||o.placeholder||"",u=o.fallbackTag||o.placeholderTag||"span";return f(u,s,d)}}}),M=async(t,e)=>{const s=`/api/course/chapter/${t}/lesson/${e}`;return await D(s)};const j={__name:"CompleteLessonButton",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(t){return(e,s)=>(C(),f("button",{class:I(["btn py-4",{"btn-primary":!t.modelValue,"btn-success":t.modelValue}]),onClick:s[0]||(s[0]=n=>e.$emit("update:modelValue",!t.modelValue))},m(t.modelValue?"Completed":"Mark as completed"),3))}},q=O(j,[["__scopeId","data-v-ce9c288f"]]),H=P("courseProgress",()=>{y();const t=b({}),e=b(!1);async function s(){e.value||(e.value=!0)}return{initialize:s,progress:t,toggleComplete:async(o,l)=>{var a;const d=y();if(!d.value)return;if(!o||!l){const{params:{chapterSession:r,lessonSlug:p}}=S();o=r,l=p}const u=(a=t.value[o])==null?void 0:a[l];t.value[o]={...t.value[o],[l]:!u};try{await $fetch(`/api/course/chapter/${o}/lesson/${l}/progress`,{method:"POST",body:{completed:!u,userEmail:d.value.email}})}catch(r){console.error(r),t.value[o]={...t.value[o],[l]:u}}}}}),R={class:"w-3/4 mx-auto h-3/4 my-auto gap-6 flex flex-col"},W={class:"text-xl font-semibold"},F={class:"text-4xl font-bold"},Q={__name:"[lessonSlug]",async setup(t){let e,s;const n=H(),{initialize:o,toggleComplete:l}=n,d=y();console.log(d.value.email),o();const u=([e,s]=x(()=>N()),e=await e,s(),e),{params:a}=S(),r=([e,s]=x(()=>M(a.chapterSession,a.lessonSlug)),e=await e,s(),e),p=g(()=>u.value.data.chapters.find(c=>c.slug==a.chapterSession)),k=g(()=>p.value.lessons.find(c=>c.slug==a.lessonSlug)),w=g(()=>{var c,_;return((_=(c=n.progress)==null?void 0:c[a.chapterSession])==null?void 0:_[a.lessonSlug])||!1});return T({title:`${k.value.title}`}),(c,_)=>{const $=A,B=E;return C(),f("div",R,[h("h4",W," Chapter "+m(i(p).number)+" - Lesson "+m(i(r).data.number),1),h("h1",F,m(i(r).data.title),1),v($,{videoID:i(r).data.videoId},null,8,["videoID"]),h("p",null,m(i(r).data.text),1),v(B,null,{default:z(()=>[v(q,{modelValue:i(w),"onUpdate:modelValue":i(l)},null,8,["modelValue","onUpdate:modelValue"])]),_:1})])}}};export{Q as default};
